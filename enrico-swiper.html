<link rel="import" href="../polymer/polymer.html">
<link rel="import" href="../paper-icon-button/paper-icon-button.html">
<link rel="import" href="../iron-icons/hardware-icons.html">

<link rel="import" href="swiper-styles.html">
<script src="../swiper/dist/js/swiper.js"></script>

<dom-module id="enrico-swiper">

  <template>
    <style include="swiper-styles">
      :host {
        display: block;
      }
      #myContent {
        display: none;
      }
      .button-prev, .button-next {
        color: white;
        z-index: 1;
        width: 50px;
        height: 50px;
        position: absolute;
        top: 50%;
        transform: translate3d(0px, -50%, 0);
      }
      .button-next {
        right: 5px;
        left: auto;
      }
      .button-prev {
        right: auto;
        left: 5px;
      }
    </style>

    <content id="myContent" hidden></content>
    <!-- Slider main container -->
    <div class="swiper-container" id="swiper">
      <!-- Additional required wrapper -->
      <div class="swiper-wrapper" id="wrapper"> </div>
      <!-- <div class="swiper-pagination"></div> -->

      <paper-icon-button class="wiper-slide-next button-next" id="next" icon="hardware:keyboard-arrow-right"></paper-icon-button>
      <paper-icon-button class="wiper-slide-prev button-prev" id="prev" icon="hardware:keyboard-arrow-left"></paper-icon-button>

      <!-- <div class="swiper-scrollbar"></div> -->
    </div>

  </template>

  <script>
    Polymer({

      is: 'enrico-swiper',

      properties: {
        options: {
          type: Object,
        },
      },
      listeners: {
        'track': 'preventTrack'
      },
      preventTrack: function (e) {
        if (!e) {
          return e;
        }
        e.cancelBubble = true;
        e.preventDefault();
      },
      ready: function() {
        var boundHandler = this._childrenChanged.bind(this);
        this._observer = Polymer.dom(this.$.myContent).observeNodes(boundHandler);
      },
      _childrenChanged: function(info) {
        var nodes = info.addedNodes.filter(function(node) {
          return (node.nodeType === Node.ELEMENT_NODE && node.tagName != "TEMPLATE")
        });
        for (var i = 0; i < nodes.length; i++) {
          var swiperSlide = document.createElement('div');
          swiperSlide.setAttribute("class","swiper-slide");
          Polymer.dom(swiperSlide).appendChild(nodes[i]);
          Polymer.dom(this.$.wrapper).appendChild(swiperSlide);
        }
        if(this.options == undefined) {
          this.options = {};
        }
        this.options.prevButton = this.$.prev;
        this.options.nextButton = this.$.next;

        if(this.mySwiper != undefined) {
          this.mySwiper.destroy();
        }

        this.mySwiper = new window.Swiper(this.$.swiper, this.options);
      },
    });
  </script>
</dom-module>
